---
- name: install kubectl repository
  uri:
    url: https://dl.k8s.io/release/stable.txt
    return_content: yes
  register: version
- name: Download the latest kubectl release
  uri:
    url: https://dl.k8s.io/release/{{ version.content }}/bin/linux/arm/kubectl
    dest: /home/{{ ansible_user }}
  register: kubectl
- name: Check if kubectl is installed
  shell: kubectl version --client
  register: client
  failed_when: client.rc > 1
- name: Installing Docker
  apt:
    name: docker
    state: present
- name: Installing conntrack
  apt:
    name: conntrack
    state: present
- name: Downloading minikube
  get_url:
    url: https://storage.googleapis.com/minikube/releases/latest/minikube-latest.x86_64.rpm
    dest: /root/minikube-latest.x86_64.rpm
- name: Installing minkube
  apt:
    name: /root/minikube-latest.x86_64.rpm
    state: present
- name: Starting Minikube driver using none
  become: yes
  shell: |
    minkube start --driver=none
